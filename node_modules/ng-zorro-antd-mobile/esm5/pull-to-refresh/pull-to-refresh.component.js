import { __decorate, __metadata } from "tslib";
import { Input, Output, Component, ViewChild, forwardRef, TemplateRef, HostBinding, EventEmitter, HostListener, ViewContainerRef, ViewEncapsulation, ElementRef } from '@angular/core';
import { NG_VALUE_ACCESSOR } from '@angular/forms';
var PullToRefreshComponent = /** @class */ (function () {
    function PullToRefreshComponent(ele) {
        this.ele = ele;
        this.transtionCls = {};
        this.style = {
            '-webkit-transform': 'translate3d( 0, 0, 0 )',
            transform: 'translate3d( 0, 0, 0 )'
        };
        this.state = {
            currentState: 'deactivate',
            drag: false
        };
        this._headerIndicator = {
            activate: '松开立即刷新',
            deactivate: '下拉可以刷新',
            release: '刷新中。。。',
            finish: '完成刷新'
        };
        this._footerIndicator = {
            activate: '松开立即刷新',
            deactivate: '上拉可以刷新',
            release: '刷新中。。。',
            finish: '完成刷新'
        };
        this._startTime = 0;
        this._endTime = 0;
        this._endReach = false;
        this._direction = '';
        this._clientHeight = 0;
        this._currentContentHeight = 0;
        this._lastContentOffset = 0;
        this.distanceToRefresh = 25; //触发刷新距离
        this.damping = 100; // 下拉的最大距离
        this.endReachedRefresh = false;
        this.refreshing = false;
        this.onRefresh = new EventEmitter();
        this.refresh = true;
        this.container = true;
        this.refreshUp = this._direction === 'up' || this._direction === '';
        this.refreshDown = this._direction === 'down' || this._direction === '';
    }
    PullToRefreshComponent_1 = PullToRefreshComponent;
    Object.defineProperty(PullToRefreshComponent.prototype, "direction", {
        get: function () {
            return this._direction;
        },
        set: function (value) {
            this._direction = value;
            this.refreshUp = this._direction === 'up' || this._direction === '';
            this.refreshDown = this._direction === 'down' || this._direction === '';
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(PullToRefreshComponent.prototype, "headerIndicator", {
        get: function () {
            return this._headerIndicator;
        },
        set: function (value) {
            Object.assign(this._headerIndicator, value);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(PullToRefreshComponent.prototype, "footerIndicator", {
        get: function () {
            return this._footerIndicator;
        },
        set: function (value) {
            Object.assign(this._footerIndicator, value);
        },
        enumerable: true,
        configurable: true
    });
    PullToRefreshComponent.prototype.touchstart = function (e) {
        this._startTime = Date.now();
        if (this._direction === 'down' || (this._direction === '' && !this._endReach)) {
            if (this.ele.nativeElement.scrollTop > 0) {
                this.startY = undefined;
                return;
            }
            this.startY = e && e.changedTouches && e.changedTouches[0] && e.changedTouches[0].clientY;
            this.state.drag = undefined;
        }
        else {
            this.startY = e && e.changedTouches && e.changedTouches[0] && e.changedTouches[0].clientY;
            this._clientHeight = this._pullToRefresh.element.nativeElement.clientHeight;
            this._currentContentHeight = this.ele.nativeElement.clientHeight;
        }
        this.transtionCls = '';
    };
    PullToRefreshComponent.prototype.touchmove = function (e) {
        if (this._direction === 'down' || (this._direction === '' && !this._endReach)) {
            if (this.ele.nativeElement.scrollTop > 0) {
                return;
            }
            var distanceY = e.changedTouches[0].clientY - this.startY;
            this.state.drag = distanceY >= 0;
            if (this.state.drag) {
                // 禁止滚动
                if (e.cancelable) {
                    e.preventDefault();
                }
            }
            else {
                return;
            }
            if (distanceY > this.damping) {
                //当超过设定阈值是，缓慢增加
                distanceY = (distanceY / (distanceY + this.damping)) * this.damping * 2;
            }
            else if (distanceY < 0) {
                distanceY = 0;
            }
            if (distanceY > this.distanceToRefresh) {
                this.state.currentState = 'activate';
                if (this._ngModelOnChange) {
                    this._ngModelOnChange(this.state);
                }
            }
            this.style = {
                '-webkit-transform': 'translate3d( 0, ' + distanceY + 'px, 0 )',
                transform: 'translate3d( 0, ' + distanceY + 'px, 0 )'
            };
        }
        else {
            var distanceY = e.changedTouches[0].clientY - this.startY;
            //向上拉动的时候，如果当前窗口内容没有滚到最后，则不实现拖动的动作；向下滚动不实现拖动动作
            if (Math.abs(this._lastContentOffset) < this._clientHeight - this._currentContentHeight - this.distanceToRefresh ||
                distanceY > 0) {
                // 滚动
                this.state.drag = false;
            }
            else {
                // 上拉
                this.state.drag = true;
            }
            if (this.state.drag) {
                // 禁止滚动
                if (e.cancelable) {
                    e.preventDefault();
                }
            }
            else {
                return;
            }
            //如果滑动到底部了，滑动距离随着拉动的距离增加缓慢增加
            distanceY = -(distanceY / (distanceY - this.damping)) * this.damping;
            if (Math.abs(distanceY) > this.distanceToRefresh) {
                this.state.currentState = 'activate';
                if (this._ngModelOnChange) {
                    this._ngModelOnChange(this.state);
                }
            }
            this.style = {
                '-webkit-transform': 'translate3d( 0, ' + distanceY + 'px, 0 )',
                transform: 'translate3d( 0, ' + distanceY + 'px, 0 )'
            };
        }
    };
    PullToRefreshComponent.prototype.touchend = function (e) {
        var _this = this;
        if (!this.startY || this.state.drag === false) {
            return;
        }
        var distanceY = e.changedTouches[0].clientY - this.startY;
        if (Math.abs(distanceY) >= this.distanceToRefresh) {
            this.state.currentState = 'release';
            if (this._direction === 'down' || (this._direction === '' && !this._endReach)) {
                this.translateY(this.distanceToRefresh + 1);
            }
            else {
                this.translateY(-this.distanceToRefresh - 1);
            }
            if (this._ngModelOnChange) {
                this._ngModelOnChange(this.state);
            }
            setTimeout(function () {
                _this.state.currentState = 'finish';
                if (_this._ngModelOnChange) {
                    _this._ngModelOnChange(_this.state);
                }
                if (_this._direction === 'down' || (_this._direction === '' && !_this._endReach)) {
                    _this.onRefresh.emit('down');
                }
                else {
                    _this.translateY(-_this.distanceToRefresh - 1);
                    _this.onRefresh.emit('up');
                }
                setTimeout(function () {
                    _this.state.currentState = 'deactivate';
                    if (_this._ngModelOnChange) {
                        _this._ngModelOnChange(_this.state);
                    }
                    _this.translateY(0);
                }, 0);
            }, 500);
        }
        else {
            this.translateY(0);
        }
    };
    PullToRefreshComponent.prototype.touchcancel = function () {
        this.translateY(0);
    };
    PullToRefreshComponent.prototype.scroll = function (evt) {
        var _this = this;
        this._endTime = Date.now();
        var contentOffset = evt.target.scrollTop;
        this._lastContentOffset = contentOffset;
        if (this._direction === '') {
            if (contentOffset > 0 && evt.target.scrollTop + this.ele.nativeElement.clientHeight === evt.target.scrollHeight) {
                setTimeout(function () {
                    _this._endReach = true;
                }, 100);
            }
            else {
                this._endReach = false;
            }
        }
        if (!this.endReachedRefresh || this._direction !== 'down') {
            return;
        }
        if (contentOffset > 0 &&
            evt.target.scrollTop + this.ele.nativeElement.clientHeight > evt.target.scrollHeight - this.distanceToRefresh &&
            this._endTime - this._startTime >= 100) {
            this._startTime = this._endTime;
            if (this.refreshing) {
                this.state.currentState = 'release';
                if (this._ngModelOnChange) {
                    this._ngModelOnChange(this.state);
                }
            }
            setTimeout(function () {
                if (_this.endReachedRefresh) {
                    _this.onRefresh.emit('endReachedRefresh');
                }
                if (_this.refreshing) {
                    _this.state.currentState = 'finish';
                    if (_this._ngModelOnChange) {
                        _this._ngModelOnChange(_this.state);
                    }
                }
            }, 500);
        }
        else {
            setTimeout(function () {
                if (_this.refreshing) {
                    _this.state.currentState = 'finish';
                    if (_this._ngModelOnChange) {
                        _this._ngModelOnChange(_this.state);
                    }
                }
            }, 500);
        }
    };
    PullToRefreshComponent.prototype.isTemplateRef = function (value) {
        return value instanceof TemplateRef;
    };
    PullToRefreshComponent.prototype.translateY = function (distanceY) {
        this.transtionCls = 'am-pull-to-refresh-transition';
        this.style = {
            '-webkit-transform': 'translate3d( 0, ' + distanceY + 'px, 0 )',
            transform: 'translate3d( 0, ' + distanceY + 'px, 0 )'
        };
    };
    PullToRefreshComponent.prototype.writeValue = function (value) {
        if (value !== null) {
            this.state = value;
        }
    };
    PullToRefreshComponent.prototype.registerOnChange = function (fn) {
        this._ngModelOnChange = fn;
    };
    PullToRefreshComponent.prototype.registerOnTouched = function (fn) {
        this._ngModelOnTouched = fn;
    };
    var PullToRefreshComponent_1;
    PullToRefreshComponent.ctorParameters = function () { return [
        { type: ElementRef }
    ]; };
    __decorate([
        ViewChild('pullToRefresh', { read: ViewContainerRef, static: true }),
        __metadata("design:type", ViewContainerRef)
    ], PullToRefreshComponent.prototype, "_pullToRefresh", void 0);
    __decorate([
        Input(),
        __metadata("design:type", Number)
    ], PullToRefreshComponent.prototype, "distanceToRefresh", void 0);
    __decorate([
        Input(),
        __metadata("design:type", Number)
    ], PullToRefreshComponent.prototype, "damping", void 0);
    __decorate([
        Input(),
        __metadata("design:type", Boolean)
    ], PullToRefreshComponent.prototype, "endReachedRefresh", void 0);
    __decorate([
        Input(),
        __metadata("design:type", Boolean)
    ], PullToRefreshComponent.prototype, "refreshing", void 0);
    __decorate([
        Input(),
        __metadata("design:type", String),
        __metadata("design:paramtypes", [String])
    ], PullToRefreshComponent.prototype, "direction", null);
    __decorate([
        Input(),
        __metadata("design:type", Object),
        __metadata("design:paramtypes", [Object])
    ], PullToRefreshComponent.prototype, "headerIndicator", null);
    __decorate([
        Input(),
        __metadata("design:type", Object),
        __metadata("design:paramtypes", [Object])
    ], PullToRefreshComponent.prototype, "footerIndicator", null);
    __decorate([
        Output(),
        __metadata("design:type", EventEmitter)
    ], PullToRefreshComponent.prototype, "onRefresh", void 0);
    __decorate([
        HostBinding('class.am-pull-to-refresh'),
        __metadata("design:type", Boolean)
    ], PullToRefreshComponent.prototype, "refresh", void 0);
    __decorate([
        HostBinding('class.super-container'),
        __metadata("design:type", Boolean)
    ], PullToRefreshComponent.prototype, "container", void 0);
    __decorate([
        HostBinding('class.am-pull-to-refresh-up'),
        __metadata("design:type", Boolean)
    ], PullToRefreshComponent.prototype, "refreshUp", void 0);
    __decorate([
        HostBinding('class.am-pull-to-refresh-down'),
        __metadata("design:type", Boolean)
    ], PullToRefreshComponent.prototype, "refreshDown", void 0);
    __decorate([
        HostListener('touchstart', ['$event']),
        __metadata("design:type", Function),
        __metadata("design:paramtypes", [Object]),
        __metadata("design:returntype", void 0)
    ], PullToRefreshComponent.prototype, "touchstart", null);
    __decorate([
        HostListener('touchmove', ['$event']),
        __metadata("design:type", Function),
        __metadata("design:paramtypes", [Object]),
        __metadata("design:returntype", void 0)
    ], PullToRefreshComponent.prototype, "touchmove", null);
    __decorate([
        HostListener('touchend', ['$event']),
        __metadata("design:type", Function),
        __metadata("design:paramtypes", [Object]),
        __metadata("design:returntype", void 0)
    ], PullToRefreshComponent.prototype, "touchend", null);
    __decorate([
        HostListener('touchcancel'),
        __metadata("design:type", Function),
        __metadata("design:paramtypes", []),
        __metadata("design:returntype", void 0)
    ], PullToRefreshComponent.prototype, "touchcancel", null);
    __decorate([
        HostListener('scroll', ['$event']),
        __metadata("design:type", Function),
        __metadata("design:paramtypes", [Object]),
        __metadata("design:returntype", void 0)
    ], PullToRefreshComponent.prototype, "scroll", null);
    PullToRefreshComponent = PullToRefreshComponent_1 = __decorate([
        Component({
            selector: 'PullToRefresh, nzm-pull-to-refresh',
            template: "<div class=\"am-pull-to-refresh-content-wrapper\">\n  <div class=\"am-pull-to-refresh-content\" [ngClass]=\"transtionCls\" [ngStyle]=\"style\">\n    <div *ngIf=\"refreshDown\" class=\"am-pull-to-refresh-indicator am-pull-to-refresh-header-indicator\">\n      <ng-template\n        *ngIf=\"isTemplateRef(headerIndicator[state.currentState])\"\n        [ngTemplateOutlet]=\"headerIndicator[state.currentState]\"\n      ></ng-template>\n      <ng-container *ngIf=\"!isTemplateRef(headerIndicator[state.currentState])\">{{\n        headerIndicator[state.currentState]\n      }}</ng-container>\n    </div>\n    <div #pullToRefresh>\n      <ng-content></ng-content>\n      <div\n        *ngIf=\"direction === 'down' && endReachedRefresh\"\n        class=\"am-pull-to-refresh-indicator am-pull-to-refresh-footer-indicator\"\n      >\n        <ng-template\n          *ngIf=\"isTemplateRef(footerIndicator[state.currentState])\"\n          [ngTemplateOutlet]=\"footerIndicator[state.currentState]\"\n        ></ng-template>\n        <ng-container *ngIf=\"!isTemplateRef(footerIndicator[state.currentState])\">{{\n          footerIndicator[state.currentState]\n        }}</ng-container>\n      </div>\n    </div>\n    <div *ngIf=\"refreshUp\" class=\"am-pull-to-refresh-indicator am-pull-to-refresh-footer-indicator\">\n      <ng-template\n        *ngIf=\"isTemplateRef(footerIndicator[state.currentState])\"\n        [ngTemplateOutlet]=\"footerIndicator[state.currentState]\"\n      ></ng-template>\n      <ng-container *ngIf=\"!isTemplateRef(footerIndicator[state.currentState])\">{{\n        footerIndicator[state.currentState]\n      }}</ng-container>\n    </div>\n  </div>\n</div>\n",
            encapsulation: ViewEncapsulation.None,
            providers: [
                {
                    provide: NG_VALUE_ACCESSOR,
                    useExisting: forwardRef(function () { return PullToRefreshComponent_1; }),
                    multi: true
                }
            ]
        }),
        __metadata("design:paramtypes", [ElementRef])
    ], PullToRefreshComponent);
    return PullToRefreshComponent;
}());
export { PullToRefreshComponent };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicHVsbC10by1yZWZyZXNoLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL25nLXpvcnJvLWFudGQtbW9iaWxlLyIsInNvdXJjZXMiOlsicHVsbC10by1yZWZyZXNoL3B1bGwtdG8tcmVmcmVzaC5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLE9BQU8sRUFDTCxLQUFLLEVBQ0wsTUFBTSxFQUNOLFNBQVMsRUFDVCxTQUFTLEVBQ1QsVUFBVSxFQUNWLFdBQVcsRUFDWCxXQUFXLEVBQ1gsWUFBWSxFQUNaLFlBQVksRUFDWixnQkFBZ0IsRUFDaEIsaUJBQWlCLEVBQ2pCLFVBQVUsRUFDWCxNQUFNLGVBQWUsQ0FBQztBQUN2QixPQUFPLEVBQXdCLGlCQUFpQixFQUFFLE1BQU0sZ0JBQWdCLENBQUM7QUFvQnpFO0lBcVFFLGdDQUFvQixHQUFlO1FBQWYsUUFBRyxHQUFILEdBQUcsQ0FBWTtRQXBRbkMsaUJBQVksR0FBUSxFQUFFLENBQUM7UUFDdkIsVUFBSyxHQUFXO1lBQ2QsbUJBQW1CLEVBQUUsd0JBQXdCO1lBQzdDLFNBQVMsRUFBRSx3QkFBd0I7U0FDcEMsQ0FBQztRQUVGLFVBQUssR0FBUTtZQUNYLFlBQVksRUFBRSxZQUFZO1lBQzFCLElBQUksRUFBRSxLQUFLO1NBQ1osQ0FBQztRQUVNLHFCQUFnQixHQUFjO1lBQ3BDLFFBQVEsRUFBRSxRQUFRO1lBQ2xCLFVBQVUsRUFBRSxRQUFRO1lBQ3BCLE9BQU8sRUFBRSxRQUFRO1lBQ2pCLE1BQU0sRUFBRSxNQUFNO1NBQ2YsQ0FBQztRQUVNLHFCQUFnQixHQUFjO1lBQ3BDLFFBQVEsRUFBRSxRQUFRO1lBQ2xCLFVBQVUsRUFBRSxRQUFRO1lBQ3BCLE9BQU8sRUFBRSxRQUFRO1lBQ2pCLE1BQU0sRUFBRSxNQUFNO1NBQ2YsQ0FBQztRQUVNLGVBQVUsR0FBVyxDQUFDLENBQUM7UUFDdkIsYUFBUSxHQUFXLENBQUMsQ0FBQztRQUNyQixjQUFTLEdBQVksS0FBSyxDQUFDO1FBQzNC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REFDNkI7SUFFeEU7UUFEQyxXQUFXLENBQUMsK0JBQStCLENBQUM7OytEQUMrQjtJQUc1RTtRQURDLFlBQVksQ0FBQyxZQUFZLEVBQUUsQ0FBQyxRQUFRLENBQUMsQ0FBQzs7Ozs0REFnQnRDO0lBRUQ7UUFEQyxZQUFZLENBQUMsV0FBVyxFQUFFLENBQUMsUUFBUSxDQUFDLENBQUM7Ozs7MkRBa0VyQztJQUVEO1FBREMsWUFBWSxDQUFDLFVBQVUsRUFBRSxDQUFDLFFBQVEsQ0FBQyxDQUFDOzs7OzBEQXNDcEM7SUFFRDtRQURDLFlBQVksQ0FBQyxhQUFhLENBQUM7Ozs7NkRBRzNCO0lBRUQ7UUFEQyxZQUFZLENBQUMsUUFBUSxFQUFFLENBQUMsUUFBUSxDQUFDLENBQUM7Ozs7d0RBa0RsQztJQW5RVSxzQkFBc0I7UUFabEMsU0FBUyxDQUFDO1lBQ1QsUUFBUSxFQUFFLG9DQUFvQztZQUM5Qyx5cERBQStDO1lBQy9DLGFBQWEsRUFBRSxpQkFBaUIsQ0FBQyxJQUFJO1lBQ3JDLFNBQVMsRUFBRTtnQkFDVDtvQkFDRSxPQUFPLEVBQUUsaUJBQWlCO29CQUMxQixXQUFXLEVBQUUsVUFBVSxDQUFDLGNBQU0sT0FBQSx3QkFBc0IsRUFBdEIsQ0FBc0IsQ0FBQztvQkFDckQsS0FBSyxFQUFFLElBQUk7aUJBQ1o7YUFDRjtTQUNGLENBQUM7eUNBc1F5QixVQUFVO09BclF4QixzQkFBc0IsQ0FnU2xDO0lBQUQsNkJBQUM7Q0FBQSxBQWhTRCxJQWdTQztTQWhTWSxzQkFBc0IiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xuICBJbnB1dCxcbiAgT3V0cHV0LFxuICBDb21wb25lbnQsXG4gIFZpZXdDaGlsZCxcbiAgZm9yd2FyZFJlZixcbiAgVGVtcGxhdGVSZWYsXG4gIEhvc3RCaW5kaW5nLFxuICBFdmVudEVtaXR0ZXIsXG4gIEhvc3RMaXN0ZW5lcixcbiAgVmlld0NvbnRhaW5lclJlZixcbiAgVmlld0VuY2Fwc3VsYXRpb24sXG4gIEVsZW1lbnRSZWZcbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBDb250cm9sVmFsdWVBY2Nlc3NvciwgTkdfVkFMVUVfQUNDRVNTT1IgfSBmcm9tICdAYW5ndWxhci9mb3Jtcyc7XG5leHBvcnQgaW50ZXJmYWNlIEluZGljYXRvciB7XG4gIGFjdGl2YXRlPzogYW55O1xuICBkZWFjdGl2YXRlPzogYW55O1xuICByZWxlYXNlPzogYW55O1xuICBmaW5pc2g/OiBhbnk7XG59XG5cbkBDb21wb25lbnQoe1xuICBzZWxlY3RvcjogJ1B1bGxUb1JlZnJlc2gsIG56bS1wdWxsLXRvLXJlZnJlc2gnLFxuICB0ZW1wbGF0ZVVybDogJy4vcHVsbC10by1yZWZyZXNoLmNvbXBvbmVudC5odG1sJyxcbiAgZW5jYXBzdWxhdGlvbjogVmlld0VuY2Fwc3VsYXRpb24uTm9uZSxcbiAgcHJvdmlkZXJzOiBbXG4gICAge1xuICAgICAgcHJvdmlkZTogTkdfVkFMVUVfQUNDRVNTT1IsXG4gICAgICB1c2VFeGlzdGluZzogZm9yd2FyZFJlZigoKSA9PiBQdWxsVG9SZWZyZXNoQ29tcG9uZW50KSxcbiAgICAgIG11bHRpOiB0cnVlXG4gICAgfVxuICBdXG59KVxuZXhwb3J0IGNsYXNzIFB1bGxUb1JlZnJlc2hDb21wb25lbnQgaW1wbGVtZW50cyBDb250cm9sVmFsdWVBY2Nlc3NvciB7XG4gIHRyYW5zdGlvbkNsczogYW55ID0ge307XG4gIHN0eWxlOiBvYmplY3QgPSB7XG4gICAgJy13ZWJraXQtdHJhbnNmb3JtJzogJ3RyYW5zbGF0ZTNkKCAwLCAwLCAwICknLFxuICAgIHRyYW5zZm9ybTogJ3RyYW5zbGF0ZTNkKCAwLCAwLCAwICknXG4gIH07XG4gIHN0YXJ0WTogbnVtYmVyO1xuICBzdGF0ZTogYW55ID0ge1xuICAgIGN1cnJlbnRTdGF0ZTogJ2RlYWN0aXZhdGUnLFxuICAgIGRyYWc6IGZhbHNlXG4gIH07XG5cbiAgcHJpdmF0ZSBfaGVhZGVySW5kaWNhdG9yOiBJbmRpY2F0b3IgPSB7XG4gICAgYWN0aXZhdGU6ICfmnb7lvIDnq4vljbPliLfmlrAnLFxuICAgIGRlYWN0aXZhdGU6ICfkuIvmi4nlj6/ku6XliLfmlrAnLFxuICAgIHJlbGVhc2U6ICfliLfmlrDkuK3jgILjgILjgIInLFxuICAgIGZpbmlzaDogJ+WujOaIkOWIt+aWsCdcbiAgfTtcblxuICBwcml2YXRlIF9mb290ZXJJbmRpY2F0b3I6IEluZGljYXRvciA9IHtcbiAgICBhY3RpdmF0ZTogJ+advuW8gOeri+WNs+WIt+aWsCcsXG4gICAgZGVhY3RpdmF0ZTogJ+S4iuaLieWPr+S7peWIt+aWsCcsXG4gICAgcmVsZWFzZTogJ+WIt+aWsOS4reOAguOAguOAgicsXG4gICAgZmluaXNoOiAn5a6M5oiQ5Yi35pawJ1xuICB9O1xuXG4gIHByaXZhdGUgX3N0YXJ0VGltZTogbnVtYmVyID0gMDtcbiAgcHJpdmF0ZSBfZW5kVGltZTogbnVtYmVyID0gMDtcbiAgcHJpdmF0ZSBfZW5kUmVhY2g6IGJvb2xlYW4gPSBmYWxzZTtcbiAgcHJpdmF0ZSBfZGlyZWN0aW9uOiBzdHJpbmcgPSAnJztcbiAgcHJpdmF0ZSBfY2xpZW50SGVpZ2h0OiBudW1iZXIgPSAwO1xuICBwcml2YXRlIF9jdXJyZW50Q29udGVudEhlaWdodDogbnVtYmVyID0gMDtcbiAgcHJpdmF0ZSBfbGFzdENvbnRlbnRPZmZzZXQ6IG51bWJlciA9IDA7XG4gIHByaXZhdGUgX25nTW9kZWxPbkNoYW5nZTogKHZhbHVlOiBvYmplY3QpID0+IHt9O1xuICBwcml2YXRlIF9uZ01vZGVsT25Ub3VjaGVkOiAoKSA9PiB7fTtcblxuICBAVmlld0NoaWxkKCdwdWxsVG9SZWZyZXNoJywgeyByZWFkOiBWaWV3Q29udGFpbmVyUmVmLCBzdGF0aWM6IHRydWUgfSlcbiAgcHJpdmF0ZSBfcHVsbFRvUmVmcmVzaDogVmlld0NvbnRhaW5lclJlZjtcblxuICBASW5wdXQoKVxuICBkaXN0YW5jZVRvUmVmcmVzaDogbnVtYmVyID0gMjU7IC8v6Kem5Y+R5Yi35paw6Led56a7XG4gIEBJbnB1dCgpXG4gIGRhbXBpbmc6IG51bWJlciA9IDEwMDsgLy8g5LiL5ouJ55qE5pyA5aSn6Led56a7XG4gIEBJbnB1dCgpXG4gIGVuZFJlYWNoZWRSZWZyZXNoOiBib29sZWFuID0gZmFsc2U7XG4gIEBJbnB1dCgpXG4gIHJlZnJlc2hpbmc6IGJvb2xlYW4gPSBmYWxzZTtcbiAgQElucHV0KClcbiAgZ2V0IGRpcmVjdGlvbigpOiBzdHJpbmcge1xuICAgIHJldHVybiB0aGlzLl9kaXJlY3Rpb247XG4gIH1cbiAgc2V0IGRpcmVjdGlvbih2YWx1ZTogc3RyaW5nKSB7XG4gICAgdGhpcy5fZGlyZWN0aW9uID0gdmFsdWU7XG4gICAgdGhpcy5yZWZyZXNoVXAgPSB0aGlzLl9kaXJlY3Rpb24gPT09ICd1cCcgfHwgdGhpcy5fZGlyZWN0aW9uID09PSAnJztcbiAgICB0aGlzLnJlZnJlc2hEb3duID0gdGhpcy5fZGlyZWN0aW9uID09PSAnZG93bicgfHwgdGhpcy5fZGlyZWN0aW9uID09PSAnJztcbiAgfVxuICBASW5wdXQoKVxuICBnZXQgaGVhZGVySW5kaWNhdG9yKCk6IEluZGljYXRvciB7XG4gICAgcmV0dXJuIHRoaXMuX2hlYWRlckluZGljYXRvcjtcbiAgfVxuICBzZXQgaGVhZGVySW5kaWNhdG9yKHZhbHVlOiBJbmRpY2F0b3IpIHtcbiAgICBPYmplY3QuYXNzaWduKHRoaXMuX2hlYWRlckluZGljYXRvciwgdmFsdWUpO1xuICB9XG4gIEBJbnB1dCgpXG4gIGdldCBmb290ZXJJbmRpY2F0b3IoKTogSW5kaWNhdG9yIHtcbiAgICByZXR1cm4gdGhpcy5fZm9vdGVySW5kaWNhdG9yO1xuICB9XG4gIHNldCBmb290ZXJJbmRpY2F0b3IodmFsdWU6IEluZGljYXRvcikge1xuICAgIE9iamVjdC5hc3NpZ24odGhpcy5fZm9vdGVySW5kaWNhdG9yLCB2YWx1ZSk7XG4gIH1cbiAgQE91dHB1dCgpXG4gIG9uUmVmcmVzaDogRXZlbnRFbWl0dGVyPGFueT4gPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG5cbiAgQEhvc3RCaW5kaW5nKCdjbGFzcy5hbS1wdWxsLXRvLXJlZnJlc2gnKVxuICByZWZyZXNoOiBib29sZWFuID0gdHJ1ZTtcbiAgQEhvc3RCaW5kaW5nKCdjbGFzcy5zdXBlci1jb250YWluZXInKVxuICBjb250YWluZXI6IGJvb2xlYW4gPSB0cnVlO1xuICBASG9zdEJpbmRpbmcoJ2NsYXNzLmFtLXB1bGwtdG8tcmVmcmVzaC11cCcpXG4gIHJlZnJlc2hVcDogYm9vbGVhbiA9IHRoaXMuX2RpcmVjdGlvbiA9PT0gJ3VwJyB8fCB0aGlzLl9kaXJlY3Rpb24gPT09ICcnO1xuICBASG9zdEJpbmRpbmcoJ2NsYXNzLmFtLXB1bGwtdG8tcmVmcmVzaC1kb3duJylcbiAgcmVmcmVzaERvd246IGJvb2xlYW4gPSB0aGlzLl9kaXJlY3Rpb24gPT09ICdkb3duJyB8fCB0aGlzLl9kaXJlY3Rpb24gPT09ICcnO1xuXG4gIEBIb3N0TGlzdGVuZXIoJ3RvdWNoc3RhcnQnLCBbJyRldmVudCddKVxuICB0b3VjaHN0YXJ0KGUpIHtcbiAgICB0aGlzLl9zdGFydFRpbWUgPSBEYXRlLm5vdygpO1xuICAgIGlmICh0aGlzLl9kaXJlY3Rpb24gPT09ICdkb3duJyB8fCAodGhpcy5fZGlyZWN0aW9uID09PSAnJyAmJiAhdGhpcy5fZW5kUmVhY2gpKSB7XG4gICAgICBpZiAodGhpcy5lbGUubmF0aXZlRWxlbWVudC5zY3JvbGxUb3AgPiAwKSB7XG4gICAgICAgIHRoaXMuc3RhcnRZID0gdW5kZWZpbmVkO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICB0aGlzLnN0YXJ0WSA9IGUgJiYgZS5jaGFuZ2VkVG91Y2hlcyAmJiBlLmNoYW5nZWRUb3VjaGVzWzBdICYmIGUuY2hhbmdlZFRvdWNoZXNbMF0uY2xpZW50WTtcbiAgICAgIHRoaXMuc3RhdGUuZHJhZyA9IHVuZGVmaW5lZDtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5zdGFydFkgPSBlICYmIGUuY2hhbmdlZFRvdWNoZXMgJiYgZS5jaGFuZ2VkVG91Y2hlc1swXSAmJiBlLmNoYW5nZWRUb3VjaGVzWzBdLmNsaWVudFk7XG4gICAgICB0aGlzLl9jbGllbnRIZWlnaHQgPSB0aGlzLl9wdWxsVG9SZWZyZXNoLmVsZW1lbnQubmF0aXZlRWxlbWVudC5jbGllbnRIZWlnaHQ7XG4gICAgICB0aGlzLl9jdXJyZW50Q29udGVudEhlaWdodCA9IHRoaXMuZWxlLm5hdGl2ZUVsZW1lbnQuY2xpZW50SGVpZ2h0O1xuICAgIH1cbiAgICB0aGlzLnRyYW5zdGlvbkNscyA9ICcnO1xuICB9XG4gIEBIb3N0TGlzdGVuZXIoJ3RvdWNobW92ZScsIFsnJGV2ZW50J10pXG4gIHRvdWNobW92ZShlKSB7XG4gICAgaWYgKHRoaXMuX2RpcmVjdGlvbiA9PT0gJ2Rvd24nIHx8ICh0aGlzLl9kaXJlY3Rpb24gPT09ICcnICYmICF0aGlzLl9lbmRSZWFjaCkpIHtcbiAgICAgIGlmICh0aGlzLmVsZS5uYXRpdmVFbGVtZW50LnNjcm9sbFRvcCA+IDApIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgbGV0IGRpc3RhbmNlWSA9IGUuY2hhbmdlZFRvdWNoZXNbMF0uY2xpZW50WSAtIHRoaXMuc3RhcnRZO1xuICAgICAgdGhpcy5zdGF0ZS5kcmFnID0gZGlzdGFuY2VZID49IDA7XG4gICAgICBpZiAodGhpcy5zdGF0ZS5kcmFnKSB7XG4gICAgICAgIC8vIOemgeatoua7muWKqFxuICAgICAgICBpZiAoZS5jYW5jZWxhYmxlKSB7XG4gICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBpZiAoZGlzdGFuY2VZID4gdGhpcy5kYW1waW5nKSB7XG4gICAgICAgIC8v5b2T6LaF6L+H6K6+5a6a6ZiI5YC85piv77yM57yT5oWi5aKe5YqgXG4gICAgICAgIGRpc3RhbmNlWSA9IChkaXN0YW5jZVkgLyAoZGlzdGFuY2VZICsgdGhpcy5kYW1waW5nKSkgKiB0aGlzLmRhbXBpbmcgKiAyO1xuICAgICAgfSBlbHNlIGlmIChkaXN0YW5jZVkgPCAwKSB7XG4gICAgICAgIGRpc3RhbmNlWSA9IDA7XG4gICAgICB9XG4gICAgICBpZiAoZGlzdGFuY2VZID4gdGhpcy5kaXN0YW5jZVRvUmVmcmVzaCkge1xuICAgICAgICB0aGlzLnN0YXRlLmN1cnJlbnRTdGF0ZSA9ICdhY3RpdmF0ZSc7XG4gICAgICAgIGlmICh0aGlzLl9uZ01vZGVsT25DaGFuZ2UpIHtcbiAgICAgICAgICB0aGlzLl9uZ01vZGVsT25DaGFuZ2UodGhpcy5zdGF0ZSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHRoaXMuc3R5bGUgPSB7XG4gICAgICAgICctd2Via2l0LXRyYW5zZm9ybSc6ICd0cmFuc2xhdGUzZCggMCwgJyArIGRpc3RhbmNlWSArICdweCwgMCApJyxcbiAgICAgICAgdHJhbnNmb3JtOiAndHJhbnNsYXRlM2QoIDAsICcgKyBkaXN0YW5jZVkgKyAncHgsIDAgKSdcbiAgICAgIH07XG4gICAgfSBlbHNlIHtcbiAgICAgIGxldCBkaXN0YW5jZVkgPSBlLmNoYW5nZWRUb3VjaGVzWzBdLmNsaWVudFkgLSB0aGlzLnN0YXJ0WTtcbiAgICAgIC8v5ZCR5LiK5ouJ5Yqo55qE5pe25YCZ77yM5aaC5p6c5b2T5YmN56qX5Y+j5YaF5a655rKh5pyJ5rua5Yiw5pyA5ZCO77yM5YiZ5LiN5a6e546w5ouW5Yqo55qE5Yqo5L2c77yb5ZCR5LiL5rua5Yqo5LiN5a6e546w5ouW5Yqo5Yqo5L2cXG4gICAgICBpZiAoXG4gICAgICAgIE1hdGguYWJzKHRoaXMuX2xhc3RDb250ZW50T2Zmc2V0KSA8IHRoaXMuX2NsaWVudEhlaWdodCAtIHRoaXMuX2N1cnJlbnRDb250ZW50SGVpZ2h0IC0gdGhpcy5kaXN0YW5jZVRvUmVmcmVzaCB8fFxuICAgICAgICBkaXN0YW5jZVkgPiAwXG4gICAgICApIHtcbiAgICAgICAgLy8g5rua5YqoXG4gICAgICAgIHRoaXMuc3RhdGUuZHJhZyA9IGZhbHNlO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8g5LiK5ouJXG4gICAgICAgIHRoaXMuc3RhdGUuZHJhZyA9IHRydWU7XG4gICAgICB9XG4gICAgICBpZiAodGhpcy5zdGF0ZS5kcmFnKSB7XG4gICAgICAgIC8vIOemgeatoua7muWKqFxuICAgICAgICBpZiAoZS5jYW5jZWxhYmxlKSB7XG4gICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICAvL+WmguaenOa7keWKqOWIsOW6lemDqOS6hu+8jOa7keWKqOi3neemu+maj+edgOaLieWKqOeahOi3neemu+WinuWKoOe8k+aFouWinuWKoFxuICAgICAgZGlzdGFuY2VZID0gLShkaXN0YW5jZVkgLyAoZGlzdGFuY2VZIC0gdGhpcy5kYW1waW5nKSkgKiB0aGlzLmRhbXBpbmc7XG4gICAgICBpZiAoTWF0aC5hYnMoZGlzdGFuY2VZKSA+IHRoaXMuZGlzdGFuY2VUb1JlZnJlc2gpIHtcbiAgICAgICAgdGhpcy5zdGF0ZS5jdXJyZW50U3RhdGUgPSAnYWN0aXZhdGUnO1xuICAgICAgICBpZiAodGhpcy5fbmdNb2RlbE9uQ2hhbmdlKSB7XG4gICAgICAgICAgdGhpcy5fbmdNb2RlbE9uQ2hhbmdlKHRoaXMuc3RhdGUpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICB0aGlzLnN0eWxlID0ge1xuICAgICAgICAnLXdlYmtpdC10cmFuc2Zvcm0nOiAndHJhbnNsYXRlM2QoIDAsICcgKyBkaXN0YW5jZVkgKyAncHgsIDAgKScsXG4gICAgICAgIHRyYW5zZm9ybTogJ3RyYW5zbGF0ZTNkKCAwLCAnICsgZGlzdGFuY2VZICsgJ3B4LCAwICknXG4gICAgICB9O1xuICAgIH1cbiAgfVxuICBASG9zdExpc3RlbmVyKCd0b3VjaGVuZCcsIFsnJGV2ZW50J10pXG4gIHRvdWNoZW5kKGUpIHtcbiAgICBpZiAoIXRoaXMuc3RhcnRZIHx8IHRoaXMuc3RhdGUuZHJhZyA9PT0gZmFsc2UpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgY29uc3QgZGlzdGFuY2VZID0gZS5jaGFuZ2VkVG91Y2hlc1swXS5jbGllbnRZIC0gdGhpcy5zdGFydFk7XG4gICAgaWYgKE1hdGguYWJzKGRpc3RhbmNlWSkgPj0gdGhpcy5kaXN0YW5jZVRvUmVmcmVzaCkge1xuICAgICAgdGhpcy5zdGF0ZS5jdXJyZW50U3RhdGUgPSAncmVsZWFzZSc7XG4gICAgICBpZiAodGhpcy5fZGlyZWN0aW9uID09PSAnZG93bicgfHwgKHRoaXMuX2RpcmVjdGlvbiA9PT0gJycgJiYgIXRoaXMuX2VuZFJlYWNoKSkge1xuICAgICAgICB0aGlzLnRyYW5zbGF0ZVkodGhpcy5kaXN0YW5jZVRvUmVmcmVzaCArIDEpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy50cmFuc2xhdGVZKC10aGlzLmRpc3RhbmNlVG9SZWZyZXNoIC0gMSk7XG4gICAgICB9XG4gICAgICBpZiAodGhpcy5fbmdNb2RlbE9uQ2hhbmdlKSB7XG4gICAgICAgIHRoaXMuX25nTW9kZWxPbkNoYW5nZSh0aGlzLnN0YXRlKTtcbiAgICAgIH1cbiAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICB0aGlzLnN0YXRlLmN1cnJlbnRTdGF0ZSA9ICdmaW5pc2gnO1xuICAgICAgICBpZiAodGhpcy5fbmdNb2RlbE9uQ2hhbmdlKSB7XG4gICAgICAgICAgdGhpcy5fbmdNb2RlbE9uQ2hhbmdlKHRoaXMuc3RhdGUpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLl9kaXJlY3Rpb24gPT09ICdkb3duJyB8fCAodGhpcy5fZGlyZWN0aW9uID09PSAnJyAmJiAhdGhpcy5fZW5kUmVhY2gpKSB7XG4gICAgICAgICAgdGhpcy5vblJlZnJlc2guZW1pdCgnZG93bicpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMudHJhbnNsYXRlWSgtdGhpcy5kaXN0YW5jZVRvUmVmcmVzaCAtIDEpO1xuICAgICAgICAgIHRoaXMub25SZWZyZXNoLmVtaXQoJ3VwJyk7XG4gICAgICAgIH1cbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgdGhpcy5zdGF0ZS5jdXJyZW50U3RhdGUgPSAnZGVhY3RpdmF0ZSc7XG4gICAgICAgICAgaWYgKHRoaXMuX25nTW9kZWxPbkNoYW5nZSkge1xuICAgICAgICAgICAgdGhpcy5fbmdNb2RlbE9uQ2hhbmdlKHRoaXMuc3RhdGUpO1xuICAgICAgICAgIH1cbiAgICAgICAgICB0aGlzLnRyYW5zbGF0ZVkoMCk7XG4gICAgICAgIH0sIDApO1xuICAgICAgfSwgNTAwKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy50cmFuc2xhdGVZKDApO1xuICAgIH1cbiAgfVxuICBASG9zdExpc3RlbmVyKCd0b3VjaGNhbmNlbCcpXG4gIHRvdWNoY2FuY2VsKCkge1xuICAgIHRoaXMudHJhbnNsYXRlWSgwKTtcbiAgfVxuICBASG9zdExpc3RlbmVyKCdzY3JvbGwnLCBbJyRldmVudCddKVxuICBzY3JvbGwoZXZ0KSB7XG4gICAgdGhpcy5fZW5kVGltZSA9IERhdGUubm93KCk7XG4gICAgY29uc3QgY29udGVudE9mZnNldCA9IGV2dC50YXJnZXQuc2Nyb2xsVG9wO1xuICAgIHRoaXMuX2xhc3RDb250ZW50T2Zmc2V0ID0gY29udGVudE9mZnNldDtcbiAgICBpZiAodGhpcy5fZGlyZWN0aW9uID09PSAnJykge1xuICAgICAgaWYgKGNvbnRlbnRPZmZzZXQgPiAwICYmIGV2dC50YXJnZXQuc2Nyb2xsVG9wICsgdGhpcy5lbGUubmF0aXZlRWxlbWVudC5jbGllbnRIZWlnaHQgPT09IGV2dC50YXJnZXQuc2Nyb2xsSGVpZ2h0KSB7XG4gICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgIHRoaXMuX2VuZFJlYWNoID0gdHJ1ZTtcbiAgICAgICAgfSwgMTAwKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuX2VuZFJlYWNoID0gZmFsc2U7XG4gICAgICB9XG4gICAgfVxuICAgIGlmICghdGhpcy5lbmRSZWFjaGVkUmVmcmVzaCB8fCB0aGlzLl9kaXJlY3Rpb24gIT09ICdkb3duJykge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAoXG4gICAgICBjb250ZW50T2Zmc2V0ID4gMCAmJlxuICAgICAgZXZ0LnRhcmdldC5zY3JvbGxUb3AgKyB0aGlzLmVsZS5uYXRpdmVFbGVtZW50LmNsaWVudEhlaWdodCA+IGV2dC50YXJnZXQuc2Nyb2xsSGVpZ2h0IC0gdGhpcy5kaXN0YW5jZVRvUmVmcmVzaCAmJlxuICAgICAgdGhpcy5fZW5kVGltZSAtIHRoaXMuX3N0YXJ0VGltZSA+PSAxMDBcbiAgICApIHtcbiAgICAgIHRoaXMuX3N0YXJ0VGltZSA9IHRoaXMuX2VuZFRpbWU7XG4gICAgICBpZiAodGhpcy5yZWZyZXNoaW5nKSB7XG4gICAgICAgIHRoaXMuc3RhdGUuY3VycmVudFN0YXRlID0gJ3JlbGVhc2UnO1xuICAgICAgICBpZiAodGhpcy5fbmdNb2RlbE9uQ2hhbmdlKSB7XG4gICAgICAgICAgdGhpcy5fbmdNb2RlbE9uQ2hhbmdlKHRoaXMuc3RhdGUpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgaWYgKHRoaXMuZW5kUmVhY2hlZFJlZnJlc2gpIHtcbiAgICAgICAgICB0aGlzLm9uUmVmcmVzaC5lbWl0KCdlbmRSZWFjaGVkUmVmcmVzaCcpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnJlZnJlc2hpbmcpIHtcbiAgICAgICAgICB0aGlzLnN0YXRlLmN1cnJlbnRTdGF0ZSA9ICdmaW5pc2gnO1xuICAgICAgICAgIGlmICh0aGlzLl9uZ01vZGVsT25DaGFuZ2UpIHtcbiAgICAgICAgICAgIHRoaXMuX25nTW9kZWxPbkNoYW5nZSh0aGlzLnN0YXRlKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0sIDUwMCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICBpZiAodGhpcy5yZWZyZXNoaW5nKSB7XG4gICAgICAgICAgdGhpcy5zdGF0ZS5jdXJyZW50U3RhdGUgPSAnZmluaXNoJztcbiAgICAgICAgICBpZiAodGhpcy5fbmdNb2RlbE9uQ2hhbmdlKSB7XG4gICAgICAgICAgICB0aGlzLl9uZ01vZGVsT25DaGFuZ2UodGhpcy5zdGF0ZSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9LCA1MDApO1xuICAgIH1cbiAgfVxuXG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgZWxlOiBFbGVtZW50UmVmKSB7fVxuXG4gIGlzVGVtcGxhdGVSZWYodmFsdWUpIHtcbiAgICByZXR1cm4gdmFsdWUgaW5zdGFuY2VvZiBUZW1wbGF0ZVJlZjtcbiAgfVxuXG4gIHRyYW5zbGF0ZVkoZGlzdGFuY2VZKSB7XG4gICAgdGhpcy50cmFuc3Rpb25DbHMgPSAnYW0tcHVsbC10by1yZWZyZXNoLXRyYW5zaXRpb24nO1xuICAgIHRoaXMuc3R5bGUgPSB7XG4gICAgICAnLXdlYmtpdC10cmFuc2Zvcm0nOiAndHJhbnNsYXRlM2QoIDAsICcgKyBkaXN0YW5jZVkgKyAncHgsIDAgKScsXG4gICAgICB0cmFuc2Zvcm06ICd0cmFuc2xhdGUzZCggMCwgJyArIGRpc3RhbmNlWSArICdweCwgMCApJ1xuICAgIH07XG4gIH1cblxuICB3cml0ZVZhbHVlKHZhbHVlOiBvYmplY3QpOiB2b2lkIHtcbiAgICBpZiAodmFsdWUgIT09IG51bGwpIHtcbiAgICAgIHRoaXMuc3RhdGUgPSB2YWx1ZTtcbiAgICB9XG4gIH1cblxuICByZWdpc3Rlck9uQ2hhbmdlKGZuOiAoXzogb2JqZWN0KSA9PiB7fSk6IHZvaWQge1xuICAgIHRoaXMuX25nTW9kZWxPbkNoYW5nZSA9IGZuO1xuICB9XG5cbiAgcmVnaXN0ZXJPblRvdWNoZWQoZm46ICgpID0+IHt9KTogdm9pZCB7XG4gICAgdGhpcy5fbmdNb2RlbE9uVG91Y2hlZCA9IGZuO1xuICB9XG59XG4iXX0=